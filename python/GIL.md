# GIL

- GIL是在CPython虚拟机（解释器）中的
- GIL：全局解释器锁，每个线程在执行过程中都要获取GIL，保证同一时刻只有一个线程工作。CPython会轮流执行 Python 线程。这样一来，用户看到的就是“伪”并行，即 Python 线程在交替执行，来模拟真正并行的线程。
- GIL不代表不会产生线程安全问题
- 线程释放GIL锁的情况：
  - 在IO操作等可能引起阻塞的system call之前，可以暂时释放GIL锁，但在执行完毕后必须重新获取GIL锁。
  - CPython 解释器会去轮询检查线程 GIL 的锁住情况，每隔一段时间，Python 解释器就会强制当前线程去释放 GIL，这样别的线程才能有执行的机会。Python 3 以后，间隔时间大致为 15 毫秒，即CPython 解释器会在一个**合理**的时间范围内释放 GIL。
- python使用多进程是可以利用多核的cpu资源的
- 多线程比单线程爬取速度快，因为在爬取过程中会遇到IO阻塞，释放GIL
- 在计算密集型的情况下，不建议使用多线程。计算过程中，单线程一直在同一任务下执行，没有执行完，切换了线程的，切换过程也会增加损耗，多线程会比单线程，执行更长的时间。

## 协程和GIL

- 协程只能人为的指定在什么情况下切换。不过协程和异步IO结合使用，可以达到遇到IO就切换的效果。
- GIL可以自己切换
